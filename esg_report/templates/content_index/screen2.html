{% if content_index_data.report_type == "GRI Report: In accordance With" %}
<div>
  <table style="margin: 0px; border-collapse: collapse; border: none; width: 100%;">
    <thead>
      <tr style="background-color: #3B82F6;">
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">GRI Standards and Other Resources</th>
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Disclosure</th>
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Location</th>
        <th colspan="3" style="padding: 12px; text-align: center; color: #fff; font-size: 11px; border: 1px solid #D1D5DB;">Omission</th>
      </tr>
      <tr style="background-color: #3B82F6;">
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Req omitted</th>
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Reason</th>
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Explanation</th>
      </tr>
    </thead>
    <tbody style="background-color: white; border-top: 1px solid #E5E7EB;">
      {% for block in content_index_data.sections %}
        <tr style="background-color: #F1F7FF;">
          <td colspan="6" style="padding: 12px; font-weight: 600; font-size: 11px; color: #0F6CBD;">{{ block.heading1 }}</td>
        </tr>

        {% if block.heading1 == "General Disclosures" %}
          {% for row in block.items %}
            <tr style="font-size: 10px; color: #333; page-break-inside: avoid;">
              {% if forloop.first %}
                <td rowspan="{{ block.items|length }}" style="padding: 12px; border: 1px solid #D1D5DB; vertical-align: top;">GRI 2: General Disclosures 2021</td>
              {% endif %}
              <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.title|default:"" }}</td>
              <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.page_number|default:"" }}</td>
              {% with row.omission.0 as omit %}
                <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.req_omitted|default:"" }}</td>
                <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.reason|default:"" }}</td>
                <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.explanation|default:"" }}</td>
              {% endwith %}
            </tr>
          {% endfor %}
        {% endif %}

        {% if block.heading1 == "Material Topics" and block.sections %}
          {% for heading2 in block.sections %}
            <tr><td colspan="6" style="padding: 10px; font-weight: 500; font-size: 10px; background-color: #E8F0FE;">{{ heading2.heading2 }}</td></tr>
            {% for heading3 in heading2.sections %}
              {% for row in heading3.items %}
                <tr style="font-size: 10px; color: #333;">
                  {% if forloop.first %}
                    <td rowspan="{{ heading3.items|length }}" style="padding: 12px; border: 1px solid #D1D5DB; vertical-align: top;">{{ heading3.heading3 }}</td>
                  {% endif %}
                  <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.title|default:"" }}</td>
                  <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.page_number|default:"" }}</td>
                  {% with row.omission.0 as omit %}
                    <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.req_omitted|default:"" }}</td>
                    <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.reason|default:"" }}</td>
                    <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.explanation|default:"" }}</td>
                  {% endwith %}
                </tr>
              {% endfor %}
            {% endfor %}
          {% endfor %}
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
</div>

{% elif content_index_data.report_type == "GRI Report: With Reference to" %}
<div>
  <table style="margin: 0px; border-collapse: collapse; border: none; width: 100%;">
    <thead>
      <tr style="background-color: #3B82F6;">
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">GRI Standards and Other Resources</th>
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Disclosure</th>
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Location</th>
        <th colspan="3" style="padding: 12px; text-align: center; color: #fff; font-size: 11px; border: 1px solid #D1D5DB;">Omission</th>
      </tr>
      <tr style="background-color: #3B82F6;">
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Req omitted</th>
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Reason</th>
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Explanation</th>
      </tr>
    </thead>
    <tbody>
      {% for section in content_index_data.sections %}
        {% for block in section %}
          <tr style="background-color: #F1F7FF;">
            <td colspan="6" style="padding: 12px; font-weight: 600; font-size: 11px; color: #0F6CBD;">{{ block.heading1 }}</td>
          </tr>
          {% for row in block.items %}
            <tr style="font-size: 10px; color: #333;">
              {% if forloop.first %}
                <td rowspan="{{ block.items|length }}" style="padding: 12px; border: 1px solid #D1D5DB; vertical-align: top;">{{ block.heading1 }}</td>
              {% endif %}
              <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.title|default:"" }}</td>
              <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.page_number|default:"" }}</td>
              {% with row.omission.0 as omit %}
                <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.req_omitted|default:"" }}</td>
                <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.reason|default:"" }}</td>
                <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.explanation|default:"" }}</td>
              {% endwith %}
            </tr>
          {% endfor %}
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>
</div>

{% else %}
<div>
  <table style="margin: 0px; border-collapse: collapse; border: none; width: 100%;">
    <thead>
      <tr style="background-color: #3B82F6;">
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">GRI Standards and Other Resources</th>
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Disclosure</th>
        <th rowspan="2" style="padding: 12px; border: 1px solid #D1D5DB; color: #fff; font-size: 11px;">Location</th>
        <th colspan="3" style="padding: 12px; text-align: center; color: #fff; font-size: 11px; border: 1px solid #D1D5DB;">Omission</th>
      </tr>
      <tr style="background-color: #3B82F6;">
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff;">Req omitted</th>
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff;">Reason</th>
        <th style="padding: 12px; border: 1px solid #D1D5DB; color: #fff;">Explanation</th>
      </tr>
    </thead>
    <tbody>
      {% for row in content_index_data %}
        <tr style="font-size: 10px; color: #333;">
          <td style="padding: 12px; border: 1px solid #D1D5DB;">GRI 2: General Disclosures 2021</td>
          <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.title|default:"" }}</td>
          <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ row.page_number|default:"" }}</td>
          {% with row.omission.0 as omit %}
            <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.req_omitted|default:"" }}</td>
            <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.reason|default:"" }}</td>
            <td style="padding: 12px; border: 1px solid #D1D5DB;">{{ omit.explanation|default:"" }}</td>
          {% endwith %}
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}
